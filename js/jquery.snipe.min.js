// Generated by CoffeeScript 1.4.0
(function(){var e,t,n,r,i;e=jQuery;r={"class":"snipe-lens",size:200,animation:null,image:null,css:{borderRadius:200,width:200,height:200,border:"5px solid grey",cursor:"crosshair",backgroundColor:"white"},zoomin:function(e){},zoomout:function(e){},zoommoved:function(e){}};i={position:"absolute",top:0,left:0,backgroundRepeat:"no-repeat"};t=function(){function e(e,t,n,r){this.top=e;this.right=t;this.bottom=n;this.left=r;this}e.prototype.contains=function(e,t){return this.left<e&&e<this.right&&this.top<t&&t<this.bottom};return e}();n=function(){function n(n,r){this.el=n;this.body=e("body");this.settings=this.makeSettings(r);this.offset=this.el.position();this.lens=e("<div>").addClass(this.settings["class"]).css(this.settings.css).appendTo("body");this.ratioEl=e("<img>").attr("src",this.settings.image).css("display","block").appendTo(this.el.parent());this.ratioX=1;this.ratioY=1;this.bounds=new t(this.offset.top,this.offset.left+this.el.width(),this.offset.top+this.el.height(),this.offset.left)}n.prototype.makeSettings=function(t){r.image=t.image||this.el.data("zoom")||this.el.attr("src")||this.el.find("a:first").attr("href")||this.el.find("img:first").attr("src");r.css.backgroundImage="url("+r.image+")";r.css=e.extend({},r.css,t&&t.css,i);return e.extend({},r,t)};n.prototype.run=function(){var e=this;this.ratioEl.load(function(){return e.calculateRatio(e)});return this.show()};n.prototype.calculateRatio=function(e){console.log(e.ratioEl.width(),e.el.width());e.ratioX=e.ratioEl.width()/e.el.width();e.ratioY=e.ratioEl.height()/e.el.height();console.log(e.ratioEl.width(),e.ratioEl.height());e.ratioEl.remove();return e};n.prototype.onMouseMove=function(e){var t,n;this.bounds.contains(e.pageX,e.pageY)||this.hide();t=-((e.pageX-this.offset.left)*this.ratioX-this.settings.size*.5);n=-((e.pageY-this.offset.top)*this.ratioY-this.settings.size*.5);return this.lens.css({left:e.pageX-this.settings.size*.5,top:e.pageY-this.settings.size*.5,backgroundPosition:t+"px "+n+"px"})};n.prototype.show=function(e){var t=this;e==null&&(e=!0);this.lens.show();this.el.unbind("mouseenter");this.body.bind("mousemove",function(e){return t.onMouseMove(e)});return this};n.prototype.hide=function(e){var t=this;e==null&&(e=!0);this.lens.hide();this.el.bind("mouseenter",function(e){return t.show()});this.body.unbind("mousemove");return this};return n}();(function(e){return e.fn.snipe=function(e){return(new n(this,e)).run()}})(jQuery)}).call(this);