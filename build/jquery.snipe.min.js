/*! jquery.snipe - v0.2.0 - 2013-07-10 */!function(){var a,b,c,d;a=jQuery,d={"class":"snipe-lens",size:200,ratio:null,applyCss:!0,image:{url:null,width:null,height:null},zoom:{url:null,width:null,height:null},css:{borderRadius:200,width:200,height:200,border:"2px solid white",backgroundColor:"white",boxShadow:"0 0 10px #777, 0 0 8px black inset, 0 0 80px white inset",position:"absolute",top:0,left:0,backgroundRepeat:"no-repeat",zIndex:2147483647},zoomin:function(){},zoomout:function(){},zoommoved:function(){}},b=function(){function a(a,b,c,d){return this.top=a,this.right=b,this.bottom=c,this.left=d,this}return a.prototype.update=function(a,b,c,d){this.top=a,this.right=b,this.bottom=c,this.left=d},a.prototype.contains=function(a,b){return this.left<a&&a<this.right&&this.top<b&&b<this.bottom},a}(),c=function(){function c(b,c){var d=this;return this.el=b,null==c&&(c={}),this._makeSettings(c),this._makeRatio(),this._makeBounds(),this.el.data("snipe",this),this.lens=a("<div>").addClass(this.settings["class"]).css("display","none").appendTo("body"),this.settings.applyCss&&this.lens.css(this.settings.css),this.lens.css("backgroundImage","url("+this.settings.zoom.url+")"),this.img.bind("mousemove",function(a){return d._onMouseMove(a)}),this._run(),this.el}return c.prototype._makeSettings=function(b){var c,e,f,g,h,i,j,k;return this.settings=a.extend(!0,{},d,b),this.img=this.el.is("img")?this.el:this.el.find("img:first"),null==(c=this.settings.image).url&&(c.url=this.el.data("zoom")||this.img.data("zoom")||this.el.attr("href")||this.img.attr("src")),null==(e=this.settings.image).url&&(e.url=this.img.attr("src")),null==(f=this.settings.image).width&&(f.width=this.img[0].width),null==(g=this.settings.image).height&&(g.height=this.img[0].height),null==(h=this.settings.zoom).url&&(h.url=this.el.data("zoom")||this.settings.image.url),null==(i=this.settings.zoom).width&&(i.width=this.el.data("width")||this.settings.image.width),null==(j=this.settings.zoom).height&&(j.height=this.el.data("height")||this.settings.image.height),null!=(k=this.settings).ratio?(k=this.settings).ratio:k.ratio=this.el.data("ratio")||null},c.prototype._makeBounds=function(){return this.offset=this.img.offset(),delete this.bounds,this.bounds=new b(this.offset.top,this.offset.left+this.img.width(),this.offset.top+this.img.height(),this.offset.left)},c.prototype._makeRatio=function(){return this.settings.ratio?this.ratioX=this.ratioY=this.settings.ratio:(this.ratioX=this.settings.zoom.width/this.settings.image.width,this.ratioY=this.settings.zoom.height/this.settings.image.height)},c.prototype._calculateLensBackground=function(){return this.backgroundX=-((this.mouse.x-this.offset.left)*this.ratioX-.5*this.settings.size),this.backgroundY=-((this.mouse.y-this.offset.top)*this.ratioY-.5*this.settings.size)},c.prototype._updateLens=function(){return this._calculateLensBackground(),this.lens.css({left:this.mouse.x-.5*this.settings.size,top:this.mouse.y-.5*this.settings.size,backgroundPosition:""+this.backgroundX+"px "+this.backgroundY+"px"}),this.lens[0].offsetHeight},c.prototype._onMouseMove=function(a){return this.bounds.contains(a.pageX,a.pageY)?(this.mouse={x:a.pageX,y:a.pageY},this._updateLens()):(this.hide(),void 0)},c.prototype._run=function(){var b=this;return this.hide(),a("body").on("mousemove.snipe",function(a){return b.lens.is(":visible")?(a.stopPropagation(),b._onMouseMove.call(b,a)):void 0}),this.img.on("mousemove.snipe",function(a){return a.stopPropagation(),b.off?b.show.call(b):void 0})},c.prototype.show=function(){var a;return this.el.not(":visible")&&(this._makeBounds(),this.lens.show(),"function"==typeof(a=this.settings).zoomin&&a.zoomin(this.lens),this.off=!1),this},c.prototype.hide=function(){var a;return this.lens.hide(),"function"==typeof(a=this.settings).zoomout&&a.zoomout(this.lens),this.off=!0,this},c}(),function(a){return a.fn.snipe=function(b){return this.each(function(){return a(this).data("snipe")||new c(a(this),b)})}}(jQuery)}.call(this);